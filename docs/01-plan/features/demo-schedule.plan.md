# 시연 확정 (Demo Schedule) 기획서

시연 확정 양식은 고객과의 시연 약속을 기록하고 관리하는 **'대면 영업의 첫 단추'**입니다. 방문 장소와 시간, 담당자를 명확히 정의하여 시연 완료 단계로 매끄럽게 이어지도록 설계되었습니다.

---

## 1. 시각 표준 및 UI/UX (Visual & UX Engineering)

### 1.1 모달 디자인 및 UI 물리학 (Physics & Modals)
*   **사일런트 포커스 가드 (Focus Hijack Prevention)**: 모달 진입 시 브라우저가 첫 번째 입력 필드에 강제 포커스를 두어 키보드를 팝업시키는 현상을 방지하기 위해, 투명한 더미 요소(`silentRef`)에 초기 포커스를 가두는 시스템 적용.
*   **UI 페인트 딜레이 (Paint Guard)**: 데이터 처리 트랜잭션 전 UI가 "처리 중..." 상태를 확실히 렌더링할 수 있도록 **100ms의 인위적 페인트 시간**을 확보한 후 로직 수행.
*   **마이크로 리프팅 (Tactile Feedback)**: 버튼 및 인터랙티브 요소 호버 시 `cubic-bezier` 곡선을 따라 **`translateY(-1px)`** 부상하며, 클릭 시 **`scale(0.97)`**로 축소되는 물리 효과 적용.

### 1.2 입력기 및 데이터 정규화 (Data Intelligence)
*   **TeasyDateTimeInput 슬롯 매니지먼트**:
    *   **Shift-Zero (Cursor Jump)**: 월/일 입력 시 '2' 등 단일 숫자 입력 단계에서 자동 패딩 및 다음 슬롯 즉시 점프.
    *   **Forward Delete 엔진**: 구분 기호(`-`, `:`)를 건너뛰며 다음 숫자 슬롯을 소멸시키는 슬롯 기반 삭제 로직.
    *   **Hard-Range Validation**: 시(Hour) 입력 시 24를 초과하거나 일(Day)이 31을 초과하면 해당 슬롯 즉시 공백 초기화.
*   **8종 공백 및 브랜드 정규화**:
    *   모든 입력 필드(장소, 상품 등)에서 8종의 유니코드 공백을 제거하고, 'crm' 발견 시 **대문자 'CRM'**으로 자동 교정하여 데이터 정합성 확보.

---

## 2. 기능 및 비즈니스 로직 (Functionality & Logic)

### 2.1 폼 필드 구성 및 정보 계승 (Form Fields & Inheritance)
*   **필수 항목**: 방문 예정 일시, 담당자, 방문 주소, 연락처, 시연 상품
*   **선택 항목**: 참고사항 (메모)
*   **데이터 프리필 (Pre-fill)**: 신규 작성 시 고객 마스터의 주소와 연락처를 실시간으로 획득하여 폼에 주입.
*   **필드 레이블**: 장소 입력 필드의 레이블은 **"방문 주소"**로 고정하여 사용.
*   **미래 일정 강제**: 시연 확정은 미래의 약속이므로 `limitType="past"` 속성을 통해 UI 레벨에서 과거 날짜 선택 및 입력을 원천 차단.

### 2.2 시스템 원자성 및 데이터 동기화 (Integrity)
*   **ID 선할당 (Pre-allocation)**: 트랜잭션 충돌 방지를 위해 트랜잭션 블록 외부에서 `activities` 문서 ID를 미리 생성하여 할당.
*   **3영업일 수정 기한 엔진**: 수정 권한은 문서 생성일(`createdAt`) 기준 **3영업일 이내**로 제한(주말/공휴일 제외). 3일 경과 시 Admin/Author는 삭제/수정 불가(Master 권한 독점).
*   **메타 기록 동기화**: 활동 생성 시 해당 고객의 `customer_meta` 문서 내 **`totalCount`를 아토믹하게 증가**시켜 통계 일관성 확보.
*   **원자적 트랜잭션**: `activities` 생성과 `totalCount` 갱신을 단일 사이클로 처리하여 데이터 소실 방지.

---

## 3. 타임라인 표현 표준 (Timeline Identity)

*   **조판 리듬 (Visual Rhythm)**: 일시 표시 시 날짜와 시간 사이에 **'2칸 공백(`  `)'**을 강제하고, 콜론 전후에는 **비보관 공백(`\u00A0`)**을 배치하여 줄바꿈 시 콜론이 고립되는 현상 방지. (`\u00A0:\u00A0\u00A0`)
*   **날짜 표기**: 연-월-일과 시간 사이에 **2칸 공백** 사용. (`YYYY-MM-DD  HH:mm`)
*   **담당자 메타 위계**: 퇴사자(`banned`) 회색 처리 및 `(퇴)` 접미사 적용. 협력사 직원의 경우 노란색 성명 배지 중첩 노출.
*   **보안 제어**: `lpignore` 적용으로 외부 자동완성 툴의 입력창 오염 방지.

---

## 4. 버전 기록 (Version History)

| 버전 | 날짜 | 변경 사항 |
|:---|:---|:---|
| v2.0 | 2026-02-04 | 126건 최종 팩트 체크 반영. Smart Auto-Zero, 과거 날짜 차단, 순수 숫자 정제 통합 |
| v3.0 | 2026-02-04 | 10차 정밀 감사 반영. 포커스 가드, \u00A0 콜론 조판, ID 선할당 및 물리 효과 사양 통합 |
| v3.1 | 2026-02-04 | 11차 정밀 감사 반영. Paint Guard, 2칸 공백 일시 조판 및 물리 피드백 사양 구체화 |

---
> [!NOTE]
> 본 문서는 '시연 확정' 모듈의 구현 기준점입니다. 타임라인 표시 및 하위 모듈로의 데이터 공급 설계 시 본 문서를 우선 준수합니다.
